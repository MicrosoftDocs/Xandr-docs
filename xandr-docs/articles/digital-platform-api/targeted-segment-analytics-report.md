---
title: Targeted Segment Analytics Report
description: Use the targeted segment analytics report to identify the segments that are driving impressions, clicks, and conversions in in-flight campaigns.
ms.date: 10/28/2023
ms.custom: digital-platform-api
---

# Targeted segment analytics report

> [!NOTE]
> This service is currently available to a limited set of clients and Microsoft employees only.

The **Targeted Segment Analytics** report is an admin-only report designed to give you insight into how your segment targeting is affecting the performance of your in-flight campaigns. Use cases for this report include:

- Understanding which targeted segments (both behavioral and contextual) are driving impressions, clicks and conversions within a running campaign.
- Indexing the performance of targeted segments during the campaign to identify which segments are over or underperforming.
- Understanding whether segments purchased from third parties are producing the desired performance.

> [!NOTE]
> This feature is intended to address campaign level performance; it does not include information such as a segment's aggregate performance at the [advertiser](./advertiser-service.md), [insertion order](./insertion-order-service.md), or [line item](./line-item-service.md) levels.

## Time frame

This report's data is retained for 14 days, and is available in one day intervals. All dates and times are given in UTC.

The `time_intervals` field in the request can be set to one of the following:
- `last_14_days`

## Dimensions

| Column | Type | Description |
|:---|:---|:---|
| `month` | time | The month during which the impression took place.<br><br>**Filter**: Yes |
| `day` | date | The day on which the impression took place.<br><br>**Filter**: Yes |
| `member_id` | int | The member ID of the buyer.<br><br>**Filter**: Yes |
| `campaign_id` | int | The campaign ID of the campaign that purchased the impression.<br><br>**Filter**: Yes |
| `campaign_name` | string | The name of the campaign that purchased the impression.<br><br>**Filter**: Yes |
| `campaign` | string | The concatenated name and ID of the campaign that purchased the impression, e.g., `"Amazing Campaign (31)"`<br><br>**Filter**: Yes |
| `campaign_code` | string | The (optional) custom code associated with the campaign that purchased the impression.<br><br>**Filter**: Yes |
| `segment_id` | int | The segment ID of the user segment present for this impression.<br><br>**Filter**: Yes |
| `segment_name` | string | The name of the user segment present for this impression.<br><br>**Filter**: Yes |
| `segment` | string | The concatenated name and ID of the user segment present for this impression, e.g., `"Valuable Segment (314)"`<br>**Filter**: Yes |
| `segment_code` | string | The (optional) custom code associated with the user segment present for this impression.<br><br>**Filter**: Yes |

## Metrics

> [!NOTE]
> The definition of each metric listed below should read: "that took place during the selected [Time Frame](#time-frame)".

| Column | Type | Formula | Description |
|:---|:---|:---|:---|
| `imps` | int | imps | The number of impressions that occurred. |
| `clicks` | int | clicks | The number of clicks that took place. |
| `total_convs` | int | post_view_convs + post_click_convs | The total number of conversions. |
| `convs_rate` | double | total_convs / imps | The ratio of conversions to impressions that occurred. |
| `ctr` | double | imps / clicks | The click-through-rate. |
| `total_revenue` | money | post_view_revenue + post_click_revenue | The total revenue booked through direct advertisers (at the line item level). |
| `post_view_convs` | int | post_view_convs | The number of post-view conversions. |
| `post_view_revenue` | money | post_view_revenue | The amount of revenue generated by post-view conversions through direct advertisers (at the line item level). |
| `post_click_convs` | int | post_click_convs | The number of post-click conversions that occurred. |
| `post_click_revenue` | money | post_click_revenue | The amount of revenue generated by post-click conversions through direct advertisers (at the line item level). |
| `post_view_convs_rate` | double | post_view_convs / imps | The rate of post-view conversions to impressions. |
| `post_click_convs_rate` | double | post_click_convs / imps | The rate of post-click conversions to impressions. |
| `spend` | money | spend | The total marketer spend across both direct and real time media buys for this segment. |
| `media_cost` | money | media_cost | The total cost of the inventory purchased. |
| `revenue_ecpm` | money | total_revenue / clicks | The total revenue per 1000 impressions. |
| `revenue_ecpc` | money | total_revenue / click | The revenue per click. |
| `revenue_ecpa` | money | total_revenue / total_convs | The total revenue per conversion. |

## Example

### Request the report

```
$ cat the_request.json
 
{
    "report": {
        "report_type": "targeted_segment_analytics",
        "format": "csv",
        "report_interval": "last_14_days",
        "columns": [
            "day",
            "member_id",
            "campaign",
            "segment",
            "segment_code",
            "media_cost",
            "imps",
            "clicks",
            "revenue_ecpm",
            "ctr",
            "convs_rate"
        ],
        "filters": [
            {
                "campaign_id": "827286"
            }
        ]
    }
}
 
$ curl -bc -cc -X POST -d @the_request.json 'https://api.appnexus.com/report'
 
// Note that the response contains some internal-only debugging info if you request it as an admin user.
 
{
    "response": {
        "status": "OK",
        "report": {
            "name": "",
            "created_on": "2013-11-20 19:29:34",
            "cache_hit": false,
            "fact_cache_hit": false,
            "fact_cache_error": "did not find any cache table for 1,2,30,31,32,34,36,66,6",
            "json_request": "{"report":{"filters":[{"campaign_id":"827286"},{"member_id":"541"},{"campaign_id":"827286"}],"columns":["day","member_id","campaign","segment","segment_code","media_cost","imps","clicks","revenue_ecpm","ctr","convs_rate"],"report_interval":"last_14_days","format":"csv","report_type":"targeted_segment_analytics"}}",
            "header_info": "",
            "row_count": "",
            "report_size": "",
            "internal_info": "{\"report_id\":\"823418c8d5548559948617332a1b5a23\",\"cache_miss\":1,\"cache_host\":\"vertica\",\"query\":\" SELECT to_char(ymd, 'YYYY-MM-DD') AS alias_1,buyer_member_id AS alias_2,CAMPAIGN_ID AS alias_3,segment_id AS alias_4,segment_id AS alias_5,SUM(MEDIA_COST_DOLLARS) AS alias_6,SUM(IMPS) AS alias_7,SUM(CLICKS) AS alias_8,SUM(booked_revenue_dollars) \/ (CASE WHEN SUM(imps) > 0 THEN  SUM(imps) ELSE 1 END) * 1000 AS alias_9,SUM(clicks)::numeric\/(CASE WHEN SUM(imps) > 0 THEN  SUM(imps)::numeric ELSE 1 END) AS alias_10,SUM(post_click_convs + post_view_convs)::numeric\/(CASE WHEN SUM(imps) > 0 THEN SUM(imps) ELSE 1 END) AS alias_11  FROM view_agg_dw_targeted_segments fact  WHERE 1=1  AND ymd >= '2013-11-06 00:00:00' AND ymd  < '2013-11-20 00:00:00' AND CAMPAIGN_ID IN ('827286') AND buyer_member_id IN ('541')  GROUP BY to_char(ymd, 'YYYY-MM-DD'), alias_2, alias_3, alias_4, alias_5 LIMIT 1000000001\n-- [member_id] 0\n-- [report_id] 823418c8d5548559948617332a1b5a23\"}",
            "user_id": "14311",
            "entity_id": "0",
            "started_on": "2013-11-20 19:29:34",
            "finished_on": "1970-01-01 00:00:01",
            "query_time": ""
        },
        "execution_status": "pending",
        "dbg_info": {
            "instance": "29.bm-hbapi.prod.nym1",m
            "s1ave_hit": false,
            "db": "master",
            "awesomesauce_cache_used": false,
            "count_cache_used": false,
            "warnings": [],
            "time": 128.81517410278,
            "start_microtime": 1384975794.8973,
            "version": "1.14.46"
        }
    }
}
```
